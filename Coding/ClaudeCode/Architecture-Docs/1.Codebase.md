# çµ±åˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼šã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹åˆ†æ & ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ç”Ÿæˆ

ã‚ãªãŸã¯40å¹´ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çµŒé¨“ã‚’æŒã¤ã‚·ãƒ‹ã‚¢ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆã§ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ—¢å­˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹é€ ã‚’æ¢ç´¢ã—ã€ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹åˆ†æã¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ã‚’ä¸€æ‹¬ã§ç”Ÿæˆãƒ»æ›´æ–°ã—ã¦ãã ã•ã„ã€‚

## STEP 1: æ—¢å­˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹é€ ã®æ¢ç´¢

### 1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®ç™ºè¦‹
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®æ§‹é€ ã‚’æŠŠæ¡
serena list-files --recursive --include-hidden
serena analyze-directory-structure

# æ—¢å­˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã‚’ç‰¹å®š
serena find-directories --pattern="doc*|Doc*|documentation|specs|guides"
serena scan-markdown-files --recursive
```

### 1.2 æ—¢å­˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®åˆ†æ
```bash
# æ—¢å­˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å†…å®¹ã¨æ§‹é€ ã‚’åˆ†æ
serena analyze-existing-docs --categorize
serena extract-doc-metadata --find-outdated
serena map-doc-relationships
```

### 1.3 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé…ç½®æˆ¦ç•¥ã®æ±ºå®š
ç™ºè¦‹ã•ã‚ŒãŸæ§‹é€ ã«åŸºã¥ãã€ä»¥ä¸‹ã®ãƒ«ãƒ¼ãƒ«ã§é…ç½®å…ˆã‚’æ±ºå®šï¼š
- æ—¢å­˜ã® `/docs`, `/doc`, `/documentation` ãƒ•ã‚©ãƒ«ãƒ€ãŒã‚ã‚Œã°ä½¿ç”¨
- ãªã‘ã‚Œã° `/docs` ã‚’æ–°è¦ä½œæˆ
- è¨€èªåˆ¥ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆ`/docs/ja`, `/docs/en`ï¼‰ãŒã‚ã‚Œã°é©åˆ‡ã«é…ç½®

## STEP 2: ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹åˆ†æã®å®Ÿè¡Œ

### 2.1 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ãƒ»ä¾å­˜é–¢ä¿‚ã®åˆ†æ
```bash
serena analyze-dependencies --deep-scan
serena identify-tech-stack --versions
serena calculate-metrics --complexity --maintainability --technical-debt
serena analyze-code-quality --standards=enterprise
```

### 2.2 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è­˜åˆ¥
```bash
serena identify-patterns --architectural --design-patterns
serena analyze-layer-violations
serena extract-architectural-decisions
serena analyze-security-implementations
```

## STEP 3: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ã®ç”Ÿæˆãƒ»æ›´æ–°

### 3.1 æ—¢å­˜å›³ã®æ¤œè¨¼ã¨æ›´æ–°
```bash
# æ—¢å­˜ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ã‚’ç‰¹å®š
serena find-architecture-diagrams --formats="png,svg,mermaid,draw.io"
serena validate-diagram-accuracy --compare-with-code

# æ—¢å­˜å›³ã®æ›´æ–° or æ–°è¦ç”Ÿæˆã‚’åˆ¤æ–­
serena determine-update-strategy --preserve-custom-elements
```

### 3.2 åŒ…æ‹¬çš„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ã‚»ãƒƒãƒˆã®ç”Ÿæˆ
```bash
# C4ãƒ¢ãƒ‡ãƒ«ã«åŸºã¥ãæ®µéšçš„å›³è¡¨ç”Ÿæˆ
serena generate-c4-diagrams --all-levels --format=mermaid
serena create-deployment-diagram --current-infrastructure
serena generate-data-flow-diagram --include-external-services
serena create-security-architecture --trust-boundaries
```

## å‡ºåŠ›æ§‹æˆï¼ˆ.tmpå†…ä½œæ¥­â†’ç¢ºå®šé…ç½®ï¼‰

### A. .tmpå†…ã§ã®åˆ†æçµæœãƒ¬ãƒãƒ¼ãƒˆä½œæˆ
æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ™ãƒ¼ã‚¹ã«.tmpå†…ã§å®‰å…¨ã«æ›´æ–°ï¼š

**æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°ã®.tmpå†…ãƒ—ãƒ­ã‚»ã‚¹**ï¼š
```bash
# 1. æ—¢å­˜åˆ†æãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Œã°.tmp/workingã«ã‚³ãƒ”ãƒ¼
if [ -f "docs/analysis/codebase-analysis.md" ]; then
    cp "docs/analysis/codebase-analysis.md" ".tmp/working/codebase-analysis.md"
    serena enhance-existing-analysis ".tmp/working/codebase-analysis.md" --preserve-structure
elif [ -f "analysis.md" ]; then
    cp "analysis.md" ".tmp/working/analysis.md"
    serena enhance-existing-analysis ".tmp/working/analysis.md" --preserve-structure
else
    serena create-analysis-report ".tmp/working/codebase-analysis.md" --from-scratch
fi

# 2. .tmpå†…ã§ã®å†…å®¹æ›´æ–°ãƒ»ç¢ºèª
serena update-analysis-content ".tmp/working/" --add-missing-sections --preserve-important
serena validate-analysis-quality ".tmp/working/" --completeness-check
```

### B. .tmpå†…ã§ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ã‚»ãƒƒãƒˆä½œæˆ
**æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ã®.tmpå†…ã§ã®å„ªå…ˆçš„æ›´æ–°**ï¼š

#### æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³ã®.tmpå†…æ¤œå‡ºãƒ»æ›´æ–°
```bash
# æ—¢å­˜ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ•ã‚¡ã‚¤ãƒ«ã®.tmpå†…æ›´æ–°
if [ -f ".tmp/original/architecture.md" ]; then
    cp ".tmp/original/architecture.md" ".tmp/working/architecture.md"
    serena update-file ".tmp/working/architecture.md" --preserve-structure --enhance-content
elif [ -f ".tmp/original/docs/architecture.md" ]; then
    mkdir -p ".tmp/working/docs"
    cp ".tmp/original/docs/architecture.md" ".tmp/working/docs/architecture.md"
    serena update-file ".tmp/working/docs/architecture.md" --preserve-structure --enhance-content
else
    # æ—¢å­˜ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã«åˆã‚ã›ã¦.tmpå†…ã«æ–°è¦ä½œæˆ
    target_dir=$(serena find-best-architecture-dir --existing-preference --workspace=".tmp")
    serena create-file "${target_dir}/overview.md"
fi

# .tmpå†…ã§ã®å›³è¡¨ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†
serena organize-diagrams --workspace=".tmp/working" --preserve-existing-names
serena generate-missing-diagrams --workspace=".tmp/working" --complement-existing
```

## STEP 4: ä¸­é–“ç¢ºèªãƒ»å“è³ªãƒã‚§ãƒƒã‚¯ï¼ˆ.tmpå†…ï¼‰

### 4.1 .tmpå†…æˆæœç‰©ã®ç¢ºèª
```bash
# .tmpå†…ã§ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®å“è³ªç¢ºèª
serena validate-tmp-documents --workspace=".tmp/working" --comprehensive
serena check-link-integrity --workspace=".tmp/working" --internal-external
serena preview-documents --workspace=".tmp/working" --interactive

# æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã®æ¯”è¼ƒãƒ»å·®åˆ†ç¢ºèª
serena compare-with-original --original=".tmp/original" --working=".tmp/working" --show-diff
```

### 4.2 æ‰¿èªãƒ»ç¢ºå®šåˆ¤æ–­
```bash
# ä¸­é–“æˆæœã®ç¢ºèªãƒ»æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹
echo "=== .tmpå†…ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª ==="
ls -la .tmp/working/
echo "=== æ‰¿èªå¾Œã«æœ¬é…ç½®ã‚’å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ [y/N] ==="
read approval

if [[ $approval == "y" || $approval == "Y" ]]; then
    serena proceed-to-final-placement
else
    echo "ä½œæ¥­ã‚’.tmpå†…ã§ç¶™ç¶šã—ã¾ã™ã€‚å¿…è¦ã«å¿œã˜ã¦èª¿æ•´å¾Œã€å†å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚"
fi
```

## STEP 5: ç¢ºå®šé…ç½®ãƒ»ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

### 5.1 .tmpâ†’æœ¬ç•ªé…ç½®ã®å®Ÿè¡Œ
```bash
# æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ä¿æŒã—ãŸé…ç½®
serena deploy-from-tmp --source=".tmp/working" --destination="." --preserve-existing-names
serena update-existing-files --from-tmp --backup-original

# é…ç½®ãƒ­ã‚°ã®è¨˜éŒ²
serena log-deployment --changes-summary --file-mappings
```

### 5.2 .tmpã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãƒ»ä¿æŒ
```bash
# æˆåŠŸæ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
serena cleanup-tmp --keep-successful-run --archive-analysis
# ã¾ãŸã¯åˆ†æçµæœä¿æŒ
serena archive-tmp-results --date-stamp --compress

echo "âœ… ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åˆ†æãƒ»å›³è¡¨ç”Ÿæˆå®Œäº†"
echo "ğŸ“ ä½œæ¥­å±¥æ­´: .tmp/archive/$(date +%Y%m%d-%H%M)/"
echo "ğŸ“‹ å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«: $(serena list-updated-files)"
```

### C. æ—¢å­˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ›´æ–°ãƒ­ã‚°
**`{docs_folder}/updates/architecture-update-log.md`**
```markdown
# ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°ãƒ­ã‚°

## [æ—¥ä»˜] - åˆ†æãƒ»å›³è¡¨ã®å…¨é¢æ›´æ–°
- **æ›´æ–°ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«**: [ãƒªã‚¹ãƒˆ]
- **æ–°è¦ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«**: [ãƒªã‚¹ãƒˆ]  
- **å‰Šé™¤ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«**: [ãƒªã‚¹ãƒˆ]
- **ä¸»ãªå¤‰æ›´ç‚¹**: [æ¦‚è¦]
```

## å®Ÿè¡Œæ™‚ã®å‹•çš„åˆ¤æ–­

### æ—¢å­˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ‰±ã„
```bash
# æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹å ´åˆã®åˆ¤æ–­ãƒ­ã‚¸ãƒƒã‚¯
if [ -f "docs/architecture.md" ]; then
    serena compare-with-current --suggest-merge-strategy
    # â†’ æ—¢å­˜å†…å®¹ã‚’ä¿æŒã—ã¤ã¤æ›´æ–° or å®Œå…¨ç½®æ›ã‚’ææ¡ˆ
fi
```

### ãƒ•ã‚¡ã‚¤ãƒ«å‘½åè¦å‰‡ã®é©å¿œ
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ—¢å­˜å‘½åè¦å‰‡ã‚’æ¤œå‡ºãƒ»é©ç”¨
serena detect-naming-conventions --docs-only
serena adapt-file-names --follow-existing-pattern
```

## å“è³ªä¿è¨¼

### 1. å›³è¡¨ã®ç²¾åº¦ç¢ºèª
```bash
serena validate-architecture-accuracy --compare-implementations
serena check-diagram-consistency --cross-reference
```

### 2. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹é€ ã®æ¤œè¨¼  
```bash
serena validate-doc-structure --accessibility --navigation
serena check-internal-links --fix-broken
```

### 3. æ—¢å­˜ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¨ã®çµ±åˆ
```bash
serena integrate-with-ci --update-doc-pipeline
serena setup-auto-validation --on-code-changes
```

ã“ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«ã‚ˆã‚Šã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹é€ ã‚’å°Šé‡ã—ã¤ã¤ã€åŒ…æ‹¬çš„ãªåˆ†æã¨å›³è¡¨ç”Ÿæˆã‚’ä¸€æ‹¬ã§å®Ÿè¡Œã§ãã¾ã™ã€‚
