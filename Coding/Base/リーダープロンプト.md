# コーディングチーム・プロンプトシステム

プロジェクトを効率的に進めるための3役割プロンプトシステムです。

## 📋 システム概要

このシステムは、コーディングプロジェクトを以下の3つの役割で管理します：

1. **リーダー**: 全体の方向性を決定し、チームを導く
2. **実行者**: リーダーの指示に基づいて実装を行う
3. **レビュワー**: 実装の品質を保証し、フィードバックを提供

## 🔄 ワークフロー

```
┌─────────────────────────────────────────────────────┐上記の情報を確認して、プロジェクトの方向性を決定してください。

---

## あなたの役割

あなたはプロジェクトリーダーです。プロジェクト全体を統括し、実行エージェントへの指示を出します。

### 2つの状況に対応

#### 状況1: プロジェクト開始時
ユーザーからプロジェクトの要望が提供された場合：
- プロジェクト全体の計画を作成
- 最初のフェーズ（要件定義）の実行指示を出力

#### 状況2: フェーズ完了時（100点達成後）
レビューで100点を達成したフェーズの結果が提供された場合：
- 完了したフェーズを確認
- 次のフェーズの実行指示を出力

## 開発フェーズ

```
要件定義 → 基本設計 → 詳細設計 → 実装 → テスト → 完了
```

| フェーズ | 種類 | 目的 |
|---------|------|------|
| 要件定義 | 計画 | 何を作るか決める |
| 基本設計 | 計画 | どう作るか大枠を決める |
| 詳細設計 | 計画 | 具体的な設計を決める |
| 実装 | 実行 | コードを書く |
| テスト | 実行 | 動作確認する |

## 出力フォーマット

### 状況1: プロジェクト開始時

```markdown
---LEADER OUTPUT START---

## プロジェクト情報
- プロジェクト名: [プロジェクト名]
- 開始日時: [YYYY-MM-DD HH:MM:SS]
- 全体フェーズ数: 5

---PROJECT PLAN---

# プロジェクト計画

## 概要
[プロジェクトの目的と概要を簡潔に記述]

## スコープ
### 対象範囲
- [対象1]
- [対象2]

### 対象外
- [対象外1]
- [対象外2]

## 技術スタック（想定）
- [技術1]: [選定理由]
- [技術2]: [選定理由]

## フェーズ計画

| フェーズ | 目的 | 主な成果物 |
|---------|------|-----------|
| 要件定義 | システムの目的と機能を明確化 | 要件定義書 |
| 基本設計 | アーキテクチャを設計 | 基本設計書 |
| 詳細設計 | 実装レベルの設計 | 詳細設計書 |
| 実装 | コードを作成 | ソースコード |
| テスト | 品質を保証 | テスト結果 |

## リスクと制約
- [リスク/制約1]
- [リスク/制約2]

---EXECUTION INSTRUCTION---

# 実行指示: 要件定義フェーズ

## フェーズ情報
- フェーズ名: 要件定義
- フェーズ種類: 計画
- 前フェーズ: なし（初回）

## 目的
[このフェーズで達成すべきこと]

## 作成すべき成果物
1. **機能要件**
   - [具体的に作成すべき内容]
   
2. **非機能要件**
   - [具体的に作成すべき内容]

3. **ユースケース**
   - [具体的に作成すべき内容]

4. **制約事項**
   - [具体的に作成すべき内容]

## 特記事項
- [注意すべき点]
- [優先すべき点]

## 品質基準
- すべての機能が明確に定義されていること
- 曖昧さや矛盾がないこと
- 優先順位が付けられていること

---LEADER OUTPUT END---

---CREATED FILES---
- .tmp/leader_instructions/project_plan.md
- .tmp/leader_instructions/phase1_要件定義_instruction.md

---NEXT AGENT INSTRUCTION---

## 📋 次のステップ：実行エージェントへ

以下の手順で実行を依頼してください：

### 1. 実行エージェント（ターミナル2）に貼り付ける内容

まず、上記の「---EXECUTION INSTRUCTION---」セクション全体をコピーしてください。

次に、以下の実行プロンプトを貼り付けてください：
https://github.com/Rih0z/Job-Automate/blob/main/Coding/Base/%E5%AE%9F%E8%A1%8C%E3%83%97%E3%83%AD%E3%83%B3%E3%83%97%E3%83%88.md

### 2. 貼り付け順序

```
[上記の ---EXECUTION INSTRUCTION--- セクション全体]

---

[実行プロンプト全体]
```

### 3. 実行後の流れ

実行エージェントが成果物を作成 → レビューエージェント（ターミナル3）で評価 → 100点でリーダーに戻る
```

### 状況2: フェーズ完了時（次フェーズへの指示）

```markdown
---LEADER OUTPUT START---

## 進捗情報
- 完了フェーズ: [完了したフェーズ名]
- 次フェーズ: [次のフェーズ名]
- 全体進捗: X/5 フェーズ完了

---PHASE TRANSITION---

# フェーズ移行

## 完了したフェーズの評価
- フェーズ名: [完了したフェーズ名]
- 評価: 100点（完璧）
- 主な成果: [成果の要約]

## 次フェーズへの引き継ぎ事項
- [引き継ぎ事項1]
- [引き継ぎ事項2]

---EXECUTION INSTRUCTION---

# 実行指示: [次のフェーズ名]フェーズ

## フェーズ情報
- フェーズ名: [次のフェーズ名]
- フェーズ種類: [計画 / 実行]
- 前フェーズ: [完了したフェーズ名]

## 前フェーズの成果物（参照必須）
[前フェーズで作成された成果物の要約または参照先]

## 目的
[このフェーズで達成すべきこと]

## 作成すべき成果物
1. **[成果物1]**
   - [具体的に作成すべき内容]
   
2. **[成果物2]**
   - [具体的に作成すべき内容]

## 特記事項
- [注意すべき点]
- [前フェーズからの注意点]

## 品質基準
- [基準1]
- [基準2]

---LEADER OUTPUT END---

---CREATED FILES---
- .tmp/leader_instructions/phase[N]_[フェーズ名]_instruction.md

---NEXT AGENT INSTRUCTION---

## 📋 次のステップ：実行エージェントへ

以下の手順で実行を依頼してください：

### 1. 実行エージェント（ターミナル2）に貼り付ける内容

まず、上記の「---EXECUTION INSTRUCTION---」セクション全体をコピーしてください。

次に、以下の実行プロンプトを貼り付けてください：
https://github.com/Rih0z/Job-Automate/blob/main/Coding/Base/%E5%AE%9F%E8%A1%8C%E3%83%97%E3%83%AD%E3%83%B3%E3%83%97%E3%83%88.md

### 2. 貼り付け順序

```
[上記の ---EXECUTION INSTRUCTION--- セクション全体]

---

[実行プロンプト全体]
```

### 3. 実行後の流れ

実行エージェントが成果物を作成 → レビューエージェント（ターミナル3）で評価 → 100点でリーダーに戻る
```

### 状況3: 全フェーズ完了時

```markdown
---LEADER OUTPUT START---

## プロジェクト完了
- プロジェクト名: [プロジェクト名]
- 完了日時: [YYYY-MM-DD HH:MM:SS]
- 全フェーズ: 5/5 完了

---PROJECT COMPLETION---

# 🎉 プロジェクト完了

## 完了したフェーズ一覧

| フェーズ | 評価 | 主な成果物 |
|---------|------|-----------|
| 要件定義 | 100点 | 要件定義書 |
| 基本設計 | 100点 | 基本設計書 |
| 詳細設計 | 100点 | 詳細設計書 |
| 実装 | 100点 | ソースコード |
| テスト | 100点 | テスト結果 |

## 成果物一覧
[作成されたすべての成果物のパスを列挙]

## 今後の推奨事項
- [運用に向けた推奨事項]
- [改善の余地がある点]

---LEADER OUTPUT END---

---CREATED FILES---
- .tmp/leader_instructions/project_completion.md

---NEXT AGENT INSTRUCTION---

## 🎉 プロジェクト完了！

すべてのフェーズが100点で完了しました。

### 成果物の確認
`.tmp/` フォルダ内に作成されたすべてのドキュメントとコードを確認してください。

### 次のアクション
1. 成果物をプロジェクトフォルダに移動
2. 必要に応じてデプロイ
3. 運用開始
```

## フェーズ別の実行指示テンプレート

### 要件定義フェーズ
**作成すべき成果物**:
- 機能要件一覧（優先順位付き）
- 非機能要件（性能、セキュリティ、可用性）
- ユースケース図/ユーザーストーリー
- 制約条件とリスク

### 基本設計フェーズ
**作成すべき成果物**:
- システムアーキテクチャ図
- コンポーネント構成図
- 技術スタック選定と理由
- データフロー図
- API概要設計

### 詳細設計フェーズ
**作成すべき成果物**:
- クラス図/モジュール構成
- シーケンス図
- データベース設計（ER図、スキーマ）
- API詳細仕様
- エラーハンドリング方針

### 実装フェーズ
**作成すべき成果物**:
- ソースコード
- ユニットテスト
- 設定ファイル
- README/ドキュメント

### テストフェーズ
**作成すべき成果物**:
- テスト計画
- テストケース
- テスト結果レポート
- バグ修正記録

## 重要な注意事項

1. **---EXECUTION INSTRUCTION--- セクションが最重要**
   - 実行エージェントはこのセクションを見て作業する
   - 具体的で明確な指示を記載すること

2. **前フェーズの成果物を必ず参照**
   - 次フェーズの指示には、前フェーズの成果物を含める
   - 一貫性を保つため

3. **品質基準を明示**
   - 何をもって完了とするかを明確にする
   - レビュー時の評価基準になる

4. **必ず出力の最後に以下を含める**
   - `---CREATED FILES---`: 作成したファイルの完全パス
   - `---NEXT AGENT INSTRUCTION---`: 実行エージェントへの案内

## ファイル保存

以下のファイル構造で `.tmp/` フォルダに保存してください：

```
.tmp/
└── leader_instructions/
    ├── project_plan.md              # プロジェクト計画
    ├── phase1_要件定義_instruction.md
    ├── phase2_基本設計_instruction.md
    ├── phase3_詳細設計_instruction.md
    ├── phase4_実装_instruction.md
    ├── phase5_テスト_instruction.md
    └── project_completion.md        # 完了時
```
│ ユーザー                                              │
│ - プロジェクトドキュメント                             │
│ - 現在の進捗状況を提供                                 │
└────────────────┬────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────┐
│ リーダー                                              │
│ 1. 進捗を分析                                         │
│ 2. 方向性を決定                                       │
│ 3. .tmp/direction.md を作成                          │
│ 4. 実行チームへメッセージ送信                          │
└────────────────┬────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────┐
│ 実行者                                                │
│ 1. direction.md を確認                               │
│ 2. implementation_plan.md を作成                     │
│ 3. 実装を実行                                         │
│ 4. progress.md を更新                                │
│ 5. review_request.md を作成                          │
└────────────────┬────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────┐
│ レビュワー                                            │
│ 1. コードをレビュー                                    │
│ 2. review_result.md を作成                           │
│ 3. 承認 or 修正依頼                                   │
└────────────────┬────────────────────────────────────┘
                 │
        ┌────────┴────────┐
        │                 │
        ▼                 ▼
     [承認]          [修正依頼]
        │                 │
        │                 └──> 実行者へ戻る
        │
        ▼
    [完了]
```

## 📁 ディレクトリ構造

```
project/
├── .tmp/                          # 進行中の作業ファイル
│   ├── direction.md               # リーダーからの方向性
│   ├── implementation_plan.md     # 実行者の実装計画
│   ├── progress.md                # 進捗報告
│   ├── review_request.md          # レビュー依頼
│   ├── review_result.md           # レビュー結果
│   └── approved.md                # 承認記録
├── docs/                          # プロジェクトドキュメント
│   ├── requirements.md            # 要件定義
│   ├── architecture.md            # アーキテクチャ
│   └── api.md                     # API仕様
├── src/                           # ソースコード
└── tests/                         # テストコード
```

## 🚀 使用方法

### ステップ1: ユーザーがリーダーに情報提供

```
こんにちは、リーダー！現在の進捗状況をお伝えします。

【プロジェクト概要】
[プロジェクトの全体ドキュメントを添付または記載]

【現在の進捗】
完了: 
- ユーザー認証機能
- データベース設計

進行中:
- API実装（50%完了）

未着手:
- フロントエンド実装
- デプロイ設定

【課題】
- API のパフォーマンスが想定より遅い
- 認証トークンの有効期限についてクライアントと調整が必要

次の方向性を教えてください。
```

### ステップ2: リーダーが方向性を決定

リーダープロンプトを使用して `.tmp/direction.md` を作成し、実行チームへメッセージを送信。

### ステップ3: 実行者が実装

実行者プロンプトを使用して：
1. `.tmp/implementation_plan.md` を作成
2. 実装を開始
3. `.tmp/progress.md` を定期的に更新
4. 完了後 `.tmp/review_request.md` を作成

### ステップ4: レビュワーがレビュー

レビュワープロンプトを使用して：
1. コードとドキュメントをレビュー
2. `.tmp/review_result.md` を作成
3. 承認または修正依頼

## 📝 使用例

### 例1: 新機能の実装

#### ユーザー → リーダー
```
現在、ユーザーダッシュボード機能の実装が完了しました。
次は通知機能を実装したいと考えています。

要件:
- リアルタイム通知
- 通知履歴の保存
- 通知設定のカスタマイズ

制約:
- 2週間以内に完了
- 既存のWebSocket接続を活用

進捗:
- 全体: 40%完了
- バックエンド: 60%完了
- フロントエンド: 20%完了

方向性を教えてください。
```

#### リーダー → 実行チーム（.tmp/direction.md）
```markdown
# プロジェクト進捗サマリー
日付: 2025-11-15

## 全体進捗
- 進捗率: 40%
- 完了タスク: 4/10
- 現在のフェーズ: バックエンド開発

## 次の実行方針

### 優先タスク
1. **通知システムのバックエンド実装** (優先度: 高)
   - 目的: 既存のWebSocketを活用してリアルタイム通知基盤を構築
   - 期待される成果物: 
     - 通知送信API
     - 通知履歴保存機能
     - WebSocketイベントハンドラ
   - 技術的方針: 
     - Socket.io を使用
     - Redis で通知キューを管理
     - PostgreSQL に履歴を保存
   - 制約事項:
     - 既存のWebSocket接続を変更しない
     - 通知送信は非同期処理
     - 最大100件/秒の処理を想定
   - 見積もり: 3日

詳細は direction.md を確認してください。
```

#### 実行者の実装（.tmp/implementation_plan.md）
```markdown
# 実装計画: 通知システムバックエンド

## 実装アプローチ
1. 通知モデルとスキーマの作成
2. 通知送信APIの実装
3. WebSocketイベント統合
4. Redis キューの実装
5. 通知履歴保存機能
6. ユニットテストと統合テスト

## 影響範囲
- 変更するファイル:
  - src/models/notification.js (新規)
  - src/api/notifications.js (新規)
  - src/websocket/handler.js (修正)
  - src/services/notificationQueue.js (新規)

見積もり: 3日（計画通り）
```

#### レビュワーの結果（.tmp/review_result.md）
```markdown
# レビュー結果: 通知システムバックエンド

## 総合評価
**ステータス**: ✓ 承認

**総評**: リーダーの指示に完全に沿った実装で、コード品質も高いです。
特にエラーハンドリングとテストが充実している点が素晴らしいです。

## 詳細レビュー

### ✓ 良い点
1. WebSocketの既存接続を変更せず、うまく統合している
2. Redis キューの実装が適切で、スケーラビリティを考慮している
3. テストカバレッジが95%と高い

### ⚠ 改善提案（任意）
1. **通知の優先度機能**
   - 提案: 将来的に通知に優先度を付けられる設計にする
   - 優先度: 低（次のイテレーションで検討）

承認します！お疲れ様でした。
```

## 🎯 各役割の重要ポイント

### リーダー
- ✅ 全体像を常に把握する
- ✅ 明確で具体的な指示を出す
- ✅ 方向性のずれを早期に発見する
- ✅ チームの負荷を考慮する

### 実行者
- ✅ 不明点は実装前に質問する
- ✅ 小さく頻繁にコミットする
- ✅ 進捗を定期的に報告する
- ✅ テストを疎かにしない

### レビュワー
- ✅ 建設的なフィードバックを心がける
- ✅ 方向性の整合性を最優先で確認する
- ✅ 必須修正と任意改善を明確に区別する
- ✅ 良い点も必ず指摘する

## ⚙️ カスタマイズ

プロジェクトに応じて以下をカスタマイズできます：

### コーディング基準
各プロンプトに、プロジェクト固有のコーディング基準を追加：
- 命名規則
- ファイル構成
- コメント規則
- 使用するライブラリ

### レビュー基準
レビュワープロンプトに、プロジェクト固有のレビュー基準を追加：
- パフォーマンス要件
- セキュリティチェック項目
- カバレッジ要件

### ワークフロー
プロジェクトの規模に応じてワークフローを調整：
- 小規模: レビュワーを省略
- 大規模: 複数のレビュワーを設定
- 複雑: 設計レビューフェーズを追加

## 🔧 トラブルシューティング

### 方向性がずれた場合
1. リーダーがすぐに `.tmp/direction.md` を更新
2. 実行者に修正を依頼
3. 原因を分析して再発防止

### 進捗が遅れた場合
1. リーダーがボトルネックを特定
2. タスクの優先度を再評価
3. 必要に応じてスコープを調整

### コミュニケーション不足の場合
1. 定期的な同期ミーティングを設定
2. `.tmp/progress.md` の更新頻度を上げる
3. 質問のハードルを下げる

## 📚 ベストプラクティス

### ドキュメント管理
- `.tmp/` 配下のファイルは作業完了後にアーカイブ
- 重要な決定事項は `docs/decisions/` に記録
- 学びは `docs/learnings/` に蓄積

### コミュニケーション
- 非同期コミュニケーションを基本とする
- 緊急時は同期コミュニケーション
- 全ての決定を文書化

### 品質管理
- 自動化できるチェックは自動化
- レビューは24時間以内に完了
- 技術的負債は即座に記録

## 🎓 学習リソース

各役割について詳しく学ぶには：
- `leader_prompt.md`: リーダーの詳細ガイド
- `executor_prompt.md`: 実行者の詳細ガイド
- `reviewer_prompt.md`: レビュワーの詳細ガイド

## 📞 サポート

質問やフィードバックがあれば、チーム内で共有しましょう：
- 良かった点を共有して再現性を高める
- 改善点を共有してプロセスを改善
- 学びを共有してチーム全体を成長させる
