# コーディングチーム・プロンプトシステム

プロジェクトを効率的に進めるための3役割プロンプトシステムです。

## 📋 システム概要

このシステムは、コーディングプロジェクトを以下の3つの役割で管理します：

1. **リーダー**: 全体の方向性を決定し、チームを導く
2. **実行者**: リーダーの指示に基づいて実装を行う
3. **レビュワー**: 実装の品質を保証し、フィードバックを提供

## 🔄 ワークフロー

```
┌─────────────────────────────────────────────────────┐
│ ユーザー                                              │
│ - プロジェクトドキュメント                             │
│ - 現在の進捗状況を提供                                 │
└────────────────┬────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────┐
│ リーダー                                              │
│ 1. 進捗を分析                                         │
│ 2. 方向性を決定                                       │
│ 3. .tmp/direction.md を作成                          │
│ 4. 実行チームへメッセージ送信                          │
└────────────────┬────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────┐
│ 実行者                                                │
│ 1. direction.md を確認                               │
│ 2. implementation_plan.md を作成                     │
│ 3. 実装を実行                                         │
│ 4. progress.md を更新                                │
│ 5. review_request.md を作成                          │
└────────────────┬────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────┐
│ レビュワー                                            │
│ 1. コードをレビュー                                    │
│ 2. review_result.md を作成                           │
│ 3. 承認 or 修正依頼                                   │
└────────────────┬────────────────────────────────────┘
                 │
        ┌────────┴────────┐
        │                 │
        ▼                 ▼
     [承認]          [修正依頼]
        │                 │
        │                 └──> 実行者へ戻る
        │
        ▼
    [完了]
```

## 📁 ディレクトリ構造

```
project/
├── .tmp/                          # 進行中の作業ファイル
│   ├── direction.md               # リーダーからの方向性
│   ├── implementation_plan.md     # 実行者の実装計画
│   ├── progress.md                # 進捗報告
│   ├── review_request.md          # レビュー依頼
│   ├── review_result.md           # レビュー結果
│   └── approved.md                # 承認記録
├── docs/                          # プロジェクトドキュメント
│   ├── requirements.md            # 要件定義
│   ├── architecture.md            # アーキテクチャ
│   └── api.md                     # API仕様
├── src/                           # ソースコード
└── tests/                         # テストコード
```

## 🚀 使用方法

### ステップ1: ユーザーがリーダーに情報提供

```
こんにちは、リーダー！現在の進捗状況をお伝えします。

【プロジェクト概要】
[プロジェクトの全体ドキュメントを添付または記載]

【現在の進捗】
完了: 
- ユーザー認証機能
- データベース設計

進行中:
- API実装（50%完了）

未着手:
- フロントエンド実装
- デプロイ設定

【課題】
- API のパフォーマンスが想定より遅い
- 認証トークンの有効期限についてクライアントと調整が必要

次の方向性を教えてください。
```

### ステップ2: リーダーが方向性を決定

リーダープロンプトを使用して `.tmp/direction.md` を作成し、実行チームへメッセージを送信。

### ステップ3: 実行者が実装

実行者プロンプトを使用して：
1. `.tmp/implementation_plan.md` を作成
2. 実装を開始
3. `.tmp/progress.md` を定期的に更新
4. 完了後 `.tmp/review_request.md` を作成

### ステップ4: レビュワーがレビュー

レビュワープロンプトを使用して：
1. コードとドキュメントをレビュー
2. `.tmp/review_result.md` を作成
3. 承認または修正依頼

## 📝 使用例

### 例1: 新機能の実装

#### ユーザー → リーダー
```
現在、ユーザーダッシュボード機能の実装が完了しました。
次は通知機能を実装したいと考えています。

要件:
- リアルタイム通知
- 通知履歴の保存
- 通知設定のカスタマイズ

制約:
- 2週間以内に完了
- 既存のWebSocket接続を活用

進捗:
- 全体: 40%完了
- バックエンド: 60%完了
- フロントエンド: 20%完了

方向性を教えてください。
```

#### リーダー → 実行チーム（.tmp/direction.md）
```markdown
# プロジェクト進捗サマリー
日付: 2025-11-15

## 全体進捗
- 進捗率: 40%
- 完了タスク: 4/10
- 現在のフェーズ: バックエンド開発

## 次の実行方針

### 優先タスク
1. **通知システムのバックエンド実装** (優先度: 高)
   - 目的: 既存のWebSocketを活用してリアルタイム通知基盤を構築
   - 期待される成果物: 
     - 通知送信API
     - 通知履歴保存機能
     - WebSocketイベントハンドラ
   - 技術的方針: 
     - Socket.io を使用
     - Redis で通知キューを管理
     - PostgreSQL に履歴を保存
   - 制約事項:
     - 既存のWebSocket接続を変更しない
     - 通知送信は非同期処理
     - 最大100件/秒の処理を想定
   - 見積もり: 3日

詳細は direction.md を確認してください。
```

#### 実行者の実装（.tmp/implementation_plan.md）
```markdown
# 実装計画: 通知システムバックエンド

## 実装アプローチ
1. 通知モデルとスキーマの作成
2. 通知送信APIの実装
3. WebSocketイベント統合
4. Redis キューの実装
5. 通知履歴保存機能
6. ユニットテストと統合テスト

## 影響範囲
- 変更するファイル:
  - src/models/notification.js (新規)
  - src/api/notifications.js (新規)
  - src/websocket/handler.js (修正)
  - src/services/notificationQueue.js (新規)

見積もり: 3日（計画通り）
```

#### レビュワーの結果（.tmp/review_result.md）
```markdown
# レビュー結果: 通知システムバックエンド

## 総合評価
**ステータス**: ✓ 承認

**総評**: リーダーの指示に完全に沿った実装で、コード品質も高いです。
特にエラーハンドリングとテストが充実している点が素晴らしいです。

## 詳細レビュー

### ✓ 良い点
1. WebSocketの既存接続を変更せず、うまく統合している
2. Redis キューの実装が適切で、スケーラビリティを考慮している
3. テストカバレッジが95%と高い

### ⚠ 改善提案（任意）
1. **通知の優先度機能**
   - 提案: 将来的に通知に優先度を付けられる設計にする
   - 優先度: 低（次のイテレーションで検討）

承認します！お疲れ様でした。
```

## 🎯 各役割の重要ポイント

### リーダー
- ✅ 全体像を常に把握する
- ✅ 明確で具体的な指示を出す
- ✅ 方向性のずれを早期に発見する
- ✅ チームの負荷を考慮する

### 実行者
- ✅ 不明点は実装前に質問する
- ✅ 小さく頻繁にコミットする
- ✅ 進捗を定期的に報告する
- ✅ テストを疎かにしない

### レビュワー
- ✅ 建設的なフィードバックを心がける
- ✅ 方向性の整合性を最優先で確認する
- ✅ 必須修正と任意改善を明確に区別する
- ✅ 良い点も必ず指摘する

## ⚙️ カスタマイズ

プロジェクトに応じて以下をカスタマイズできます：

### コーディング基準
各プロンプトに、プロジェクト固有のコーディング基準を追加：
- 命名規則
- ファイル構成
- コメント規則
- 使用するライブラリ

### レビュー基準
レビュワープロンプトに、プロジェクト固有のレビュー基準を追加：
- パフォーマンス要件
- セキュリティチェック項目
- カバレッジ要件

### ワークフロー
プロジェクトの規模に応じてワークフローを調整：
- 小規模: レビュワーを省略
- 大規模: 複数のレビュワーを設定
- 複雑: 設計レビューフェーズを追加

## 🔧 トラブルシューティング

### 方向性がずれた場合
1. リーダーがすぐに `.tmp/direction.md` を更新
2. 実行者に修正を依頼
3. 原因を分析して再発防止

### 進捗が遅れた場合
1. リーダーがボトルネックを特定
2. タスクの優先度を再評価
3. 必要に応じてスコープを調整

### コミュニケーション不足の場合
1. 定期的な同期ミーティングを設定
2. `.tmp/progress.md` の更新頻度を上げる
3. 質問のハードルを下げる

## 📚 ベストプラクティス

### ドキュメント管理
- `.tmp/` 配下のファイルは作業完了後にアーカイブ
- 重要な決定事項は `docs/decisions/` に記録
- 学びは `docs/learnings/` に蓄積

### コミュニケーション
- 非同期コミュニケーションを基本とする
- 緊急時は同期コミュニケーション
- 全ての決定を文書化

### 品質管理
- 自動化できるチェックは自動化
- レビューは24時間以内に完了
- 技術的負債は即座に記録

## 🎓 学習リソース

各役割について詳しく学ぶには：
- `leader_prompt.md`: リーダーの詳細ガイド
- `executor_prompt.md`: 実行者の詳細ガイド
- `reviewer_prompt.md`: レビュワーの詳細ガイド

## 📞 サポート

質問やフィードバックがあれば、チーム内で共有しましょう：
- 良かった点を共有して再現性を高める
- 改善点を共有してプロセスを改善
- 学びを共有してチーム全体を成長させる
